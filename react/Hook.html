<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>React åŸºç¡€ - Hook | Frontend Notes</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="Just a personal frontend learning notes">
    
    <link rel="preload" href="./assets/css/0.styles.67c0caec.css" as="style"><link rel="preload" href="./assets/js/app.301adbdf.js" as="script"><link rel="preload" href="./assets/js/2.7fb28fc4.js" as="script"><link rel="preload" href="./assets/js/102.c227106d.js" as="script"><link rel="prefetch" href="./assets/js/10.393a82e6.js"><link rel="prefetch" href="./assets/js/100.36b4eb22.js"><link rel="prefetch" href="./assets/js/101.7e32476c.js"><link rel="prefetch" href="./assets/js/103.51fd0b41.js"><link rel="prefetch" href="./assets/js/104.9e06072e.js"><link rel="prefetch" href="./assets/js/105.f02e6f8c.js"><link rel="prefetch" href="./assets/js/106.0724879d.js"><link rel="prefetch" href="./assets/js/107.b73dfee4.js"><link rel="prefetch" href="./assets/js/108.be158062.js"><link rel="prefetch" href="./assets/js/109.b21635db.js"><link rel="prefetch" href="./assets/js/11.16a18534.js"><link rel="prefetch" href="./assets/js/110.959e2e8c.js"><link rel="prefetch" href="./assets/js/111.ae2f3a1f.js"><link rel="prefetch" href="./assets/js/112.ccead8c7.js"><link rel="prefetch" href="./assets/js/113.d8ba2c03.js"><link rel="prefetch" href="./assets/js/114.224cd4ad.js"><link rel="prefetch" href="./assets/js/115.34f53ac5.js"><link rel="prefetch" href="./assets/js/116.1640dc3d.js"><link rel="prefetch" href="./assets/js/117.c6de2cf5.js"><link rel="prefetch" href="./assets/js/118.cbd9533a.js"><link rel="prefetch" href="./assets/js/119.f26bfa74.js"><link rel="prefetch" href="./assets/js/12.7b4aa9e8.js"><link rel="prefetch" href="./assets/js/120.662ca9d9.js"><link rel="prefetch" href="./assets/js/121.70ec18d8.js"><link rel="prefetch" href="./assets/js/122.9b38ea16.js"><link rel="prefetch" href="./assets/js/123.ddbfda3b.js"><link rel="prefetch" href="./assets/js/124.2daf2d29.js"><link rel="prefetch" href="./assets/js/125.d8e562e8.js"><link rel="prefetch" href="./assets/js/126.19d46aba.js"><link rel="prefetch" href="./assets/js/127.9a3a0a00.js"><link rel="prefetch" href="./assets/js/13.d4c3efcc.js"><link rel="prefetch" href="./assets/js/14.834a57c4.js"><link rel="prefetch" href="./assets/js/15.b9d97d3f.js"><link rel="prefetch" href="./assets/js/16.532a9885.js"><link rel="prefetch" href="./assets/js/17.ddd110a9.js"><link rel="prefetch" href="./assets/js/18.c95b4d51.js"><link rel="prefetch" href="./assets/js/19.7bbf10cc.js"><link rel="prefetch" href="./assets/js/20.41296d5d.js"><link rel="prefetch" href="./assets/js/21.6385747f.js"><link rel="prefetch" href="./assets/js/22.1eb28bdd.js"><link rel="prefetch" href="./assets/js/23.802e32f3.js"><link rel="prefetch" href="./assets/js/24.c814c70c.js"><link rel="prefetch" href="./assets/js/25.17b13a48.js"><link rel="prefetch" href="./assets/js/26.41c698df.js"><link rel="prefetch" href="./assets/js/27.a1eb7398.js"><link rel="prefetch" href="./assets/js/28.1c4bc9ba.js"><link rel="prefetch" href="./assets/js/29.d50b40f4.js"><link rel="prefetch" href="./assets/js/3.62788466.js"><link rel="prefetch" href="./assets/js/30.b281b6c3.js"><link rel="prefetch" href="./assets/js/31.2cf82ae0.js"><link rel="prefetch" href="./assets/js/32.781a3211.js"><link rel="prefetch" href="./assets/js/33.d287edf9.js"><link rel="prefetch" href="./assets/js/34.a49959e6.js"><link rel="prefetch" href="./assets/js/35.506c14a9.js"><link rel="prefetch" href="./assets/js/36.dfa3607e.js"><link rel="prefetch" href="./assets/js/37.caf59a31.js"><link rel="prefetch" href="./assets/js/38.724c3ba6.js"><link rel="prefetch" href="./assets/js/39.caf8f090.js"><link rel="prefetch" href="./assets/js/4.24597237.js"><link rel="prefetch" href="./assets/js/40.b802c84d.js"><link rel="prefetch" href="./assets/js/41.afa27e65.js"><link rel="prefetch" href="./assets/js/42.e1860fac.js"><link rel="prefetch" href="./assets/js/43.1cfc5eee.js"><link rel="prefetch" href="./assets/js/44.d92dd569.js"><link rel="prefetch" href="./assets/js/45.5d39422d.js"><link rel="prefetch" href="./assets/js/46.6951f329.js"><link rel="prefetch" href="./assets/js/47.28f5456f.js"><link rel="prefetch" href="./assets/js/48.67fbf900.js"><link rel="prefetch" href="./assets/js/49.6aeb715f.js"><link rel="prefetch" href="./assets/js/5.b6b1f0df.js"><link rel="prefetch" href="./assets/js/50.0c6d955c.js"><link rel="prefetch" href="./assets/js/51.f02005b2.js"><link rel="prefetch" href="./assets/js/52.184180de.js"><link rel="prefetch" href="./assets/js/53.717d52a8.js"><link rel="prefetch" href="./assets/js/54.38f73799.js"><link rel="prefetch" href="./assets/js/55.d0243add.js"><link rel="prefetch" href="./assets/js/56.42188a7d.js"><link rel="prefetch" href="./assets/js/57.34d9277a.js"><link rel="prefetch" href="./assets/js/58.e1730470.js"><link rel="prefetch" href="./assets/js/59.e11bf595.js"><link rel="prefetch" href="./assets/js/6.919ce8c7.js"><link rel="prefetch" href="./assets/js/60.8100013b.js"><link rel="prefetch" href="./assets/js/61.acf09925.js"><link rel="prefetch" href="./assets/js/62.628da4e2.js"><link rel="prefetch" href="./assets/js/63.fa970fcd.js"><link rel="prefetch" href="./assets/js/64.da976388.js"><link rel="prefetch" href="./assets/js/65.10fbcea2.js"><link rel="prefetch" href="./assets/js/66.9346a5b9.js"><link rel="prefetch" href="./assets/js/67.b41b6808.js"><link rel="prefetch" href="./assets/js/68.1d63883e.js"><link rel="prefetch" href="./assets/js/69.75402122.js"><link rel="prefetch" href="./assets/js/7.84f2f586.js"><link rel="prefetch" href="./assets/js/70.9bc79ff2.js"><link rel="prefetch" href="./assets/js/71.e05b98f3.js"><link rel="prefetch" href="./assets/js/72.8491506f.js"><link rel="prefetch" href="./assets/js/73.53178297.js"><link rel="prefetch" href="./assets/js/74.21381104.js"><link rel="prefetch" href="./assets/js/75.5254f23e.js"><link rel="prefetch" href="./assets/js/76.afd34e15.js"><link rel="prefetch" href="./assets/js/77.c2e73429.js"><link rel="prefetch" href="./assets/js/78.7472b57b.js"><link rel="prefetch" href="./assets/js/79.b85bf3f8.js"><link rel="prefetch" href="./assets/js/8.57ea4c92.js"><link rel="prefetch" href="./assets/js/80.16084d0c.js"><link rel="prefetch" href="./assets/js/81.311d491f.js"><link rel="prefetch" href="./assets/js/82.14cb512f.js"><link rel="prefetch" href="./assets/js/83.d04fee8e.js"><link rel="prefetch" href="./assets/js/84.83402688.js"><link rel="prefetch" href="./assets/js/85.f9c400ea.js"><link rel="prefetch" href="./assets/js/86.e3aa2d2d.js"><link rel="prefetch" href="./assets/js/87.4b423be7.js"><link rel="prefetch" href="./assets/js/88.969a7e18.js"><link rel="prefetch" href="./assets/js/89.0838b414.js"><link rel="prefetch" href="./assets/js/9.3369e18d.js"><link rel="prefetch" href="./assets/js/90.10e7d84d.js"><link rel="prefetch" href="./assets/js/91.88c5e6f1.js"><link rel="prefetch" href="./assets/js/92.06ea8288.js"><link rel="prefetch" href="./assets/js/93.e2f8685b.js"><link rel="prefetch" href="./assets/js/94.a7d53c5a.js"><link rel="prefetch" href="./assets/js/95.81a8214d.js"><link rel="prefetch" href="./assets/js/96.1df504c4.js"><link rel="prefetch" href="./assets/js/97.785b9add.js"><link rel="prefetch" href="./assets/js/98.2a9eca43.js"><link rel="prefetch" href="./assets/js/99.b522ca2b.js">
    <link rel="stylesheet" href="./assets/css/0.styles.67c0caec.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/./" class="home-link router-link-active"><!----> <span class="site-name">Frontend Notes</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/./" class="nav-link">
  Home
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/./" class="nav-link">
  Home
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Browser</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Css</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Html</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Js</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Mobile</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Nodejs</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>React</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/./react/Basics.html" class="sidebar-link">React åŸºç¡€ - è¯­æ³•</a></li><li><a href="/./react/Communication.html" class="sidebar-link">ç»„ä»¶é—´é€šä¿¡</a></li><li><a href="/./react/Component.html" class="sidebar-link">React ç»„ä»¶</a></li><li><a href="/./react/Diff.html" class="sidebar-link">React - diff ç­–ç•¥</a></li><li><a href="/./react/Event_Handling.html" class="sidebar-link">React äº‹ä»¶å¤„ç†</a></li><li><a href="/./react/Fiber.html" class="sidebar-link">React - Fiber</a></li><li><a href="/./react/Higher_Order_Component.html" class="sidebar-link">React - é«˜é˜¶ç»„ä»¶</a></li><li><a href="/./react/Hook.html" aria-current="page" class="active sidebar-link">React åŸºç¡€ - Hook</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/./react/Hook.html#æ¦‚å¿µ" class="sidebar-link">æ¦‚å¿µ</a></li><li class="sidebar-sub-header"><a href="/./react/Hook.html#åŠ¨æœº" class="sidebar-link">åŠ¨æœº</a></li><li class="sidebar-sub-header"><a href="/./react/Hook.html#hook-ä½¿ç”¨è§„åˆ™" class="sidebar-link">Hook ä½¿ç”¨è§„åˆ™</a></li><li class="sidebar-sub-header"><a href="/./react/Hook.html#å¸¸è§-hook" class="sidebar-link">å¸¸è§ hook</a></li><li class="sidebar-sub-header"><a href="/./react/Hook.html#hook-æ¨¡æ‹Ÿ-class-ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸ" class="sidebar-link">Hook æ¨¡æ‹Ÿ class ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸ</a></li><li class="sidebar-sub-header"><a href="/./react/Hook.html#è‡ªå®šä¹‰hook" class="sidebar-link">è‡ªå®šä¹‰Hook</a></li></ul></li><li><a href="/./react/Lifecycle.html" class="sidebar-link">React ç”Ÿå‘½å‘¨æœŸ</a></li><li><a href="/./react/List.html" class="sidebar-link">React - åˆ—è¡¨</a></li><li><a href="/./react/Memo.html" class="sidebar-link">memo</a></li><li><a href="/./react/Redux.html" class="sidebar-link">Redux</a></li><li><a href="/./react/Ref.html" class="sidebar-link">React - Ref</a></li><li><a href="/./react/SetState.html" class="sidebar-link">React - setState</a></li><li><a href="/./react/Synthentic_Event.html" class="sidebar-link">React - åˆæˆäº‹ä»¶</a></li><li><a href="/./react/Virtual_DOM.html" class="sidebar-link">è™šæ‹ŸDOM</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Security</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Tricks</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Ts</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Vue</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Webpack</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="react-åŸºç¡€-hook"><a href="#react-åŸºç¡€-hook" class="header-anchor">#</a> React åŸºç¡€ - Hook</h1> <h2 id="æ¦‚å¿µ"><a href="#æ¦‚å¿µ" class="header-anchor">#</a> æ¦‚å¿µ</h2> <p>Hook æ˜¯ä¸€äº›å¯ä»¥è®©ä½ åœ¨å‡½æ•°ç»„ä»¶é‡Œâ€œé’©å…¥â€ React state åŠç”Ÿå‘½å‘¨æœŸç­‰ç‰¹æ€§çš„å‡½æ•°ã€‚</p> <h2 id="åŠ¨æœº"><a href="#åŠ¨æœº" class="header-anchor">#</a> åŠ¨æœº</h2> <h3 id="åœ¨ç»„ä»¶ä¹‹é—´å¤ç”¨çŠ¶æ€é€»è¾‘å¾ˆéš¾"><a href="#åœ¨ç»„ä»¶ä¹‹é—´å¤ç”¨çŠ¶æ€é€»è¾‘å¾ˆéš¾" class="header-anchor">#</a> åœ¨ç»„ä»¶ä¹‹é—´å¤ç”¨çŠ¶æ€é€»è¾‘å¾ˆéš¾</h3> <p>React æ²¡æœ‰æä¾›å°†å¯å¤ç”¨æ€§è¡Œä¸ºâ€œé™„åŠ â€åˆ°ç»„ä»¶çš„é€”å¾„ï¼ˆä¾‹å¦‚ï¼ŒæŠŠç»„ä»¶è¿æ¥åˆ° storeï¼‰ã€‚Hook ä½¿ä½ åœ¨æ— éœ€ä¿®æ”¹ç»„ä»¶ç»“æ„çš„æƒ…å†µä¸‹å¤ç”¨çŠ¶æ€é€»è¾‘</p> <h3 id="å¤æ‚ç»„ä»¶å˜å¾—éš¾ä»¥ç†è§£"><a href="#å¤æ‚ç»„ä»¶å˜å¾—éš¾ä»¥ç†è§£" class="header-anchor">#</a> å¤æ‚ç»„ä»¶å˜å¾—éš¾ä»¥ç†è§£</h3> <p>æˆ‘ä»¬ç»å¸¸ç»´æŠ¤ä¸€äº›ç»„ä»¶ï¼Œç»„ä»¶èµ·åˆå¾ˆç®€å•ï¼Œä½†æ˜¯é€æ¸ä¼šè¢«çŠ¶æ€é€»è¾‘å’Œå‰¯ä½œç”¨å……æ–¥ã€‚æ¯ä¸ªç”Ÿå‘½å‘¨æœŸå¸¸å¸¸åŒ…å«ä¸€äº›ä¸ç›¸å…³çš„é€»è¾‘ã€‚ç›¸äº’å…³è”ä¸”éœ€è¦å¯¹ç…§ä¿®æ”¹çš„ä»£ç è¢«è¿›è¡Œäº†æ‹†åˆ†ï¼Œè€Œå®Œå…¨ä¸ç›¸å…³çš„ä»£ç å´åœ¨åŒä¸€ä¸ªæ–¹æ³•ä¸­ç»„åˆåœ¨ä¸€èµ·ã€‚å¦‚æ­¤å¾ˆå®¹æ˜“äº§ç”Ÿ bugï¼Œå¹¶ä¸”å¯¼è‡´é€»è¾‘ä¸ä¸€è‡´ã€‚</p> <h3 id="éš¾ä»¥ç†è§£çš„-class"><a href="#éš¾ä»¥ç†è§£çš„-class" class="header-anchor">#</a> éš¾ä»¥ç†è§£çš„ class</h3> <p>ä½ å¿…é¡»å»ç†è§£ JavaScript ä¸­ this çš„å·¥ä½œæ–¹å¼ï¼Œè¿™ä¸å…¶ä»–è¯­è¨€å­˜åœ¨å·¨å¤§å·®å¼‚ã€‚è¿˜ä¸èƒ½å¿˜è®°ç»‘å®šäº‹ä»¶å¤„ç†å™¨ã€‚æ²¡æœ‰ç¨³å®šçš„è¯­æ³•ææ¡ˆï¼Œè¿™äº›ä»£ç éå¸¸å†—ä½™ã€‚
å¤§å®¶å¯ä»¥å¾ˆå¥½åœ°ç†è§£ propsï¼Œstate å’Œè‡ªé¡¶å‘ä¸‹çš„æ•°æ®æµï¼Œä½†å¯¹ class å´ä¸€ç­¹è«å±•ã€‚å³ä¾¿åœ¨æœ‰ç»éªŒçš„ React å¼€å‘è€…ä¹‹é—´ï¼Œå¯¹äºå‡½æ•°ç»„ä»¶ä¸ class ç»„ä»¶çš„å·®å¼‚ä¹Ÿå­˜åœ¨åˆ†æ­§ï¼Œç”šè‡³è¿˜è¦åŒºåˆ†ä¸¤ç§ç»„ä»¶çš„ä½¿ç”¨åœºæ™¯ã€‚</p> <h2 id="hook-ä½¿ç”¨è§„åˆ™"><a href="#hook-ä½¿ç”¨è§„åˆ™" class="header-anchor">#</a> Hook ä½¿ç”¨è§„åˆ™</h2> <ul><li>åªèƒ½åœ¨å‡½æ•°æœ€å¤–å±‚è°ƒç”¨ Hookã€‚ä¸è¦åœ¨å¾ªç¯ã€æ¡ä»¶åˆ¤æ–­æˆ–è€…å­å‡½æ•°ä¸­è°ƒç”¨ã€‚</li> <li>åªèƒ½åœ¨ React çš„å‡½æ•°ç»„ä»¶ä¸­è°ƒç”¨ Hookã€‚ä¸è¦åœ¨å…¶ä»– JavaScript å‡½æ•°ä¸­è°ƒç”¨ã€‚</li></ul> <h2 id="å¸¸è§-hook"><a href="#å¸¸è§-hook" class="header-anchor">#</a> å¸¸è§ hook</h2> <h3 id="usestate"><a href="#usestate" class="header-anchor">#</a> useState</h3> <p>é€šè¿‡åœ¨å‡½æ•°ç»„ä»¶é‡Œè°ƒç”¨å®ƒæ¥ç»™ç»„ä»¶æ·»åŠ ä¸€äº›å†…éƒ¨ stateã€‚</p> <p>React ä¼šåœ¨é‡å¤æ¸²æŸ“æ—¶ä¿ç•™è¿™ä¸ª stateã€‚</p> <p>useState ä¼šè¿”å›ä¸€å¯¹å€¼ï¼šå½“å‰çŠ¶æ€å’Œä¸€ä¸ªè®©ä½ æ›´æ–°å®ƒçš„å‡½æ•°ï¼Œä½ å¯ä»¥åœ¨äº‹ä»¶å¤„ç†å‡½æ•°ä¸­æˆ–å…¶ä»–ä¸€äº›åœ°æ–¹è°ƒç”¨è¿™ä¸ªå‡½æ•°ã€‚</p> <p>ä¸‹ä¾‹æ˜¾ç¤ºä¸€ä¸ªè®¡æ•°å™¨ã€‚å½“ä½ ç‚¹å‡»æŒ‰é’®ï¼Œè®¡æ•°å™¨çš„å€¼å°±ä¼šå¢åŠ ï¼š</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">Example</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// å£°æ˜ä¸€ä¸ªå« â€œcountâ€ çš„ state å˜é‡ã€‚</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>count<span class="token punctuation">,</span> setCount<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">You clicked </span><span class="token punctuation">{</span>count<span class="token punctuation">}</span><span class="token plain-text"> times</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setCount</span><span class="token punctuation">(</span>count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        Click me
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>useState() æ–¹æ³•é‡Œé¢å”¯ä¸€çš„å‚æ•°å°±æ˜¯åˆå§‹ stateã€‚ä¸åŒäº class çš„æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥æŒ‰ç…§éœ€è¦ä½¿ç”¨æ•°å­—æˆ–å­—ç¬¦ä¸²å¯¹å…¶è¿›è¡Œèµ‹å€¼ï¼Œè€Œä¸ä¸€å®šæ˜¯å¯¹è±¡ã€‚</p> <h4 id="usestate-æ‹¿åˆ°æœ€æ–°-state"><a href="#usestate-æ‹¿åˆ°æœ€æ–°-state" class="header-anchor">#</a> useState æ‹¿åˆ°æœ€æ–° state</h4> <p>useState hook æœ¬èº«ä¸èƒ½åšåˆ°åŒæ­¥ï¼Œæƒ³åŒæ­¥æ‹¿åˆ°æœ€æ–°çš„ state éœ€è¦å¥—ç”¨ useEffectï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">const</span> <span class="token punctuation">[</span>count<span class="token punctuation">,</span> setCount<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// æ­¤å¤„ä¸ºå¯¹ count åšçš„æ“ä½œ</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>count<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="useeffect"><a href="#useeffect" class="header-anchor">#</a> useEffect</h3> <p>ç»™å‡½æ•°ç»„ä»¶å¢åŠ äº†æ“ä½œå‰¯ä½œç”¨çš„èƒ½åŠ›ã€‚å®ƒè·Ÿ class ç»„ä»¶ä¸­çš„ componentDidMountã€componentDidUpdate å’Œ componentWillUnmount å…·æœ‰ç›¸åŒçš„ç”¨é€”ï¼Œåªä¸è¿‡è¢«åˆå¹¶æˆäº†ä¸€ä¸ª APIã€‚</p> <p>ä¸‹ä¾‹æ‰€ç¤ºçš„ç»„ä»¶åœ¨ React æ›´æ–° DOM åä¼šè®¾ç½®ä¸€ä¸ªé¡µé¢æ ‡é¢˜ï¼š</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useState<span class="token punctuation">,</span> useEffect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">Example</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>count<span class="token punctuation">,</span> setCount<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// ç›¸å½“äº componentDidMount å’Œ componentDidUpdate:</span>
  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// ä½¿ç”¨æµè§ˆå™¨çš„ API æ›´æ–°é¡µé¢æ ‡é¢˜</span>
    document<span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">You clicked </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>count<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> times</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">You clicked </span><span class="token punctuation">{</span>count<span class="token punctuation">}</span><span class="token plain-text"> times</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setCount</span><span class="token punctuation">(</span>count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        Click me
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>å½“è°ƒç”¨ useEffect æ—¶ï¼Œå°±æ˜¯åœ¨å‘Šè¯‰ React åœ¨å®Œæˆå¯¹ DOM çš„æ›´æ”¹åè¿è¡Œä½ çš„â€œå‰¯ä½œç”¨â€å‡½æ•°ã€‚</p> <p>ç”±äºå‰¯ä½œç”¨å‡½æ•°æ˜¯åœ¨ç»„ä»¶å†…å£°æ˜çš„ï¼Œæ‰€ä»¥å®ƒä»¬å¯ä»¥è®¿é—®åˆ°ç»„ä»¶çš„ props å’Œ stateã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒReact ä¼šåœ¨æ¯æ¬¡æ¸²æŸ“åè°ƒç”¨å‰¯ä½œç”¨å‡½æ•° â€”â€” åŒ…æ‹¬ç¬¬ä¸€æ¬¡æ¸²æŸ“çš„æ—¶å€™ã€‚</p> <h4 id="useeffect-è§£ç»‘å‰¯ä½œç”¨"><a href="#useeffect-è§£ç»‘å‰¯ä½œç”¨" class="header-anchor">#</a> useEffect è§£ç»‘å‰¯ä½œç”¨</h4> <p>ç»„ä»¶è¢«æ³¨é”€ä¹‹å‰æ¸…é™¤æ‰æ·»åŠ çš„æ³¨å†Œï¼Œå¦åˆ™ä¼šå‡ºç°å†…å­˜æ³„æ¼ã€‚è¿™æ—¶å¯ä»¥åœ¨å‰¯ä½œç”¨å‡½æ•°ä¸­è¿”å›ä¸€ä¸ªæ–°å‡½æ•°ï¼Œåœ¨ç»„ä»¶ä¸‹ä¸€æ¬¡æ¸²æŸ“åæ‰§è¡Œã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Comp</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token function">cleanup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">unsubscribe</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>å¯¹æ¯”ç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼šcomponentWillUnmount åªä¼šåœ¨ç»„ä»¶è¢«é”€æ¯å‰æ‰§è¡Œä¸€æ¬¡ï¼Œè€ŒuseEffecté‡Œçš„å‡½æ•°ï¼Œæ¯æ¬¡ç»„ä»¶æ¸²æŸ“åéƒ½ä¼šæ‰§è¡Œä¸€éï¼ŒåŒ…æ‹¬å‰¯ä½œç”¨å‡½æ•°è¿”å›çš„æ¸…ç†å‡½æ•°ä¹Ÿä¼šé‡æ–°æ‰§è¡Œä¸€éã€‚</p> <h4 id="useeffect-çš„æ¡ä»¶æ‰§è¡Œ"><a href="#useeffect-çš„æ¡ä»¶æ‰§è¡Œ" class="header-anchor">#</a> useEffect çš„æ¡ä»¶æ‰§è¡Œ</h4> <p>å¯¹useEffectä¼ å…¥ç¬¬äºŒä¸ªå‚æ•°ï¼Œä»…å½“ç¬¬äºŒä¸ªå‚æ•°å‘ç”Ÿå˜åŒ–æ—¶æ‰æ‰§è¡Œç¬¬ä¸€ä¸ªå‚æ•°å®šä¹‰çš„å‰¯ä½œç”¨å‡½æ•°ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// some action</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>count<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="usecontext"><a href="#usecontext" class="header-anchor">#</a> useContext</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> value <span class="token operator">=</span> <span class="token function">useContext</span><span class="token punctuation">(</span>MyContext<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>æ¥æ”¶ä¸€ä¸ª context å¯¹è±¡ï¼ˆReact.createContext çš„è¿”å›å€¼ï¼‰å¹¶è¿”å›è¯¥ context çš„å½“å‰å€¼ã€‚å½“å‰çš„ context å€¼ç”±ä¸Šå±‚ç»„ä»¶ä¸­è·ç¦»å½“å‰ç»„ä»¶æœ€è¿‘çš„ <code>&lt;MyContext.Provider&gt;</code> çš„ value prop å†³å®šã€‚</p> <p>å½“ç»„ä»¶ä¸Šå±‚æœ€è¿‘çš„ <code>&lt;MyContext.Provider&gt;</code> æ›´æ–°æ—¶ï¼Œè¯¥ Hook ä¼šè§¦å‘é‡æ¸²æŸ“ï¼Œå¹¶ä½¿ç”¨æœ€æ–°ä¼ é€’ç»™ MyContext provider çš„ context value å€¼ã€‚å³ä½¿ç¥–å…ˆä½¿ç”¨ React.memo æˆ– shouldComponentUpdateï¼Œä¹Ÿä¼šåœ¨ç»„ä»¶æœ¬èº«ä½¿ç”¨ useContext æ—¶é‡æ–°æ¸²æŸ“ã€‚</p> <h3 id="react-createcontext"><a href="#react-createcontext" class="header-anchor">#</a> React.createContext</h3> <p>å½“ React æ¸²æŸ“ä¸€ä¸ªè®¢é˜…äº†è¿™ä¸ª Context å¯¹è±¡çš„ç»„ä»¶ï¼Œè¿™ä¸ªç»„ä»¶ä¼šä»ç»„ä»¶æ ‘ä¸­ç¦»è‡ªèº«æœ€è¿‘çš„é‚£ä¸ªåŒ¹é…çš„ Provider ä¸­è¯»å–åˆ°å½“å‰çš„ context å€¼ã€‚</p> <p>åªæœ‰å½“ç»„ä»¶æ‰€å¤„çš„æ ‘ä¸­æ²¡æœ‰åŒ¹é…åˆ° Provider æ—¶ï¼Œå…¶ defaultValue å‚æ•°æ‰ä¼šç”Ÿæ•ˆã€‚</p> <h3 id="context-provider"><a href="#context-provider" class="header-anchor">#</a> Context.Provider</h3> <p>æ¯ä¸ª Context å¯¹è±¡éƒ½ä¼šè¿”å›ä¸€ä¸ª Provider React ç»„ä»¶ï¼Œå®ƒå…è®¸æ¶ˆè´¹ç»„ä»¶è®¢é˜… context çš„å˜åŒ–ã€‚</p> <p>Provider æ¥æ”¶ä¸€ä¸ª value å±æ€§ï¼Œä¼ é€’ç»™æ¶ˆè´¹ç»„ä»¶ã€‚ä¸€ä¸ª Provider å¯ä»¥å’Œå¤šä¸ªæ¶ˆè´¹ç»„ä»¶æœ‰å¯¹åº”å…³ç³»ã€‚å¤šä¸ª Provider ä¹Ÿå¯ä»¥åµŒå¥—ä½¿ç”¨ï¼Œé‡Œå±‚çš„ä¼šè¦†ç›–å¤–å±‚çš„æ•°æ®ã€‚</p> <p>ç”¨ä¾‹å‚è€ƒï¼š</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">const</span> themes <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">light</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">dark</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// åˆå§‹åŒ– context å¹¶è®¾ç½®é»˜è®¤å€¼</span>
<span class="token keyword">const</span> ThemeContext <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createContext</span><span class="token punctuation">(</span>themes<span class="token punctuation">.</span>light<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ThemeContext.Provider</span></span> <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>themes<span class="token punctuation">.</span>dark<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Toolbar</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">ThemeContext.Provider</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">Toolbar</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ThemedButton</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">ThemedButton</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> theme <span class="token operator">=</span> <span class="token function">useContext</span><span class="token punctuation">(</span>ThemeContext<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> <span class="token literal-property property">background</span><span class="token operator">:</span> theme<span class="token punctuation">.</span>background<span class="token punctuation">,</span> <span class="token literal-property property">color</span><span class="token operator">:</span> theme<span class="token punctuation">.</span>foreground <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      I am styled by theme context!
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="useref"><a href="#useref" class="header-anchor">#</a> useRef</h3> <p>useRef ç±»ä¼¼ useState ï¼Œä½†å®ƒçš„è¿”å›çš„å¯¹è±¡åœ¨æ•´ä¸ªç”Ÿå‘½å‘¨æœŸä¸­éƒ½ä¸ä¼šå˜åŒ–ï¼Œä¿®æ”¹ ref ä¹Ÿä¸ä¼šå¯¼è‡´é‡æ–°æ¸²æŸ“ã€‚ä¹Ÿå¸¸ç”¨æ¥è·å¾—å¯¹å…·ä½“DOMå…ƒç´ çš„å¼•ç”¨ã€‚</p> <p>å¾ˆå¤šä¾‹å­ä¸­ä¼šç”¨ useState æ¥æ§åˆ¶ input å…ƒç´ çš„å†…å®¹ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">const</span> <span class="token punctuation">[</span>inputVal<span class="token punctuation">,</span> setInputVal<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">&quot;default value&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">return</span> <span class="token punctuation">(</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>inputVal<span class="token punctuation">}</span></span> <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setInputVal</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>çœ‹èµ·æ¥å¾ˆåˆç†ï¼Œå®é™…ä¸Šæ¯æ•²ä¸€ä¸ªå­—ï¼Œå°±ä¼šè§¦å‘ä¸€æ¬¡ onChange ï¼Œè€Œ onChange ä¼šè°ƒç”¨ setState ï¼Œä¹Ÿå°±ä¼šè§¦å‘ä¸€æ¬¡æ¸²æŸ“ã€‚å®é™…ä¸Šå¤§éƒ¨åˆ†æ—¶å€™å¹¶ä¸å…³å¿ƒè¾“å…¥è¿‡ç¨‹ä¸­çš„å€¼ï¼Œå› æ­¤åªéœ€è¦å…³å¿ƒå®Œæˆè¾“å…¥è¦æäº¤æ—¶çš„å€¼ï¼Œè¿™é‡Œå°±ä¸åº”è¯¥è®© input å…ƒç´ çš„å€¼ç”± useState æ¥æ§åˆ¶äº†ã€‚</p> <blockquote><p>é‚£æˆ‘ä¸ç”¨ onChange ä¸å°±è¡Œäº†ï¼Ÿå®é™…ä¸Šä¸è¡Œï¼Œè¯•è¿‡å°±çŸ¥é“ï¼Œè¦ä¹ˆæä¾› onChangeï¼Œè¦ä¹ˆè®¾ç½® defaultValueï¼Œå¦åˆ™è¾“å…¥æ¡†çš„å†…å®¹å°±æ˜¯åªè¯»ã€‚</p></blockquote> <p>æ­£ç¡®æ€è·¯æ˜¯ï¼Œä½¿ç”¨ useRef æ¥è·å¾— input å…ƒç´ çš„å€¼ï¼Œç„¶ååœ¨æäº¤æ—¶å†è°ƒç”¨ setStateã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">let</span> ref <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> <span class="token punctuation">[</span>inputValue<span class="token punctuation">,</span> setInputValue<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">&quot;default&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">submitForm</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">setInputValue</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">return</span> <span class="token punctuation">(</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">ref</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>ref<span class="token punctuation">}</span></span> <span class="token attr-name">defaultValue</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>inputValue<span class="token punctuation">}</span></span><span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>submit<span class="token punctuation">&quot;</span></span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>submitForm<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
);
</span></code></pre></div><h3 id="usememo"><a href="#usememo" class="header-anchor">#</a> useMemo</h3> <p>useMemo ç”¨æ¥åœ¨å‡ æ¬¡æ¸²æŸ“ä¹‹é—´ç¼“å­˜è®¡ç®—çš„ç»“æœã€‚è¿™ä¸ªHookæ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªä¸ºæƒ³è®°å¿†ç»“æœçš„è®¡ç®—å‡½æ•°ï¼Œä¸€èˆ¬ä¸åº”è¯¥å¸¦å‚æ•°ï¼ˆå½¢å¦‚<code>()=&gt;{}</code>ï¼‰ï¼›ç¬¬äºŒä¸ªç±»ä¼¼ useEffectï¼Œä»£è¡¨é‡æ–°è®¡ç®—çš„åˆ¤æ–­ä¾èµ–ï¼Œå¦‚æœä¾èµ–å‘ç”Ÿå˜åŒ–åˆ™é‡æ–°è®¡ç®—å¹¶å­˜å‚¨è®¡ç®—ç»“æœä¾›ä¹‹åé‡ç”¨ã€‚å‡½æ•°è¿”å›çš„å€¼å³ä¸ºè¢«è®°å¿†çš„è®¡ç®—ç»“æœã€‚</p> <p>æ¯æ¬¡æ¸²æŸ“ä¹‹é—´ï¼Œreactä¼šæ¯”è¾ƒæ‰€æœ‰çš„ä¾èµ–å˜é‡ï¼Œå¦‚æœæ¯ä¸ªéƒ½æ²¡æœ‰å˜åŒ–ï¼Œåˆ™ç›´æ¥è¿”å›ä¹‹å‰æš‚å­˜çš„ç»“æœ</p> <p>ä½¿ç”¨åœºåˆå¦‚ä¸‹ï¼š</p> <ol><li><p>è·³è¿‡è€—æ—¶è¾ƒé•¿çš„è®¡ç®—è¿‡ç¨‹</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">function</span> <span class="token function">TodoList</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> todos<span class="token punctuation">,</span> tab<span class="token punctuation">,</span> theme <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> visibleTodos <span class="token operator">=</span> <span class="token function">useMemo</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">filterTodos</span><span class="token punctuation">(</span>todos<span class="token punctuation">,</span> tab<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>todos<span class="token punctuation">,</span> tab<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>è·³è¿‡ç»„ä»¶é‡æ¸²æŸ“</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">function</span> <span class="token function">TodoList</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> todos<span class="token punctuation">,</span> tab<span class="token punctuation">,</span> theme <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Tell React to cache your calculation between re-renders...</span>
  <span class="token keyword">const</span> visibleTodos <span class="token operator">=</span> <span class="token function">useMemo</span><span class="token punctuation">(</span>
    <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">filterTodos</span><span class="token punctuation">(</span>todos<span class="token punctuation">,</span> tab<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span>todos<span class="token punctuation">,</span> tab<span class="token punctuation">]</span> <span class="token comment">// ...so as long as these dependencies don't change...</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>theme<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token punctuation">{</span><span class="token comment">/* ...List will receive the same props and can skip re-rendering */</span><span class="token punctuation">}</span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">List</span></span> <span class="token attr-name">items</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>visibleTodos<span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>react ä¼šåœ¨æ¯æ¬¡é‡æ¸²æŸ“æ—¶å€™é€’å½’æ¸²æŸ“æ¯ä¸ªåµŒå¥—çš„å­ç»„ä»¶ï¼Œä½¿ç”¨ useMemo è®°å¿†å¯¼è‡´ç»„ä»¶å˜åŒ–çš„å‚æ•°å¯ä»¥é¿å…è€—æ—¶çš„é‡æ¸²æŸ“</p></li> <li><p>è®°å¿†å¦ä¸€ä¸ªHookçš„ä¾èµ–</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">function</span> <span class="token function">Dropdown</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> allItems<span class="token punctuation">,</span> text <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> searchOptions <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">matchMode</span><span class="token operator">:</span> <span class="token string">'whole-word'</span><span class="token punctuation">,</span> text <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> visibleItems <span class="token operator">=</span> <span class="token function">useMemo</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">searchItems</span><span class="token punctuation">(</span>allItems<span class="token punctuation">,</span> searchOptions<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>allItems<span class="token punctuation">,</span> searchOptions<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ğŸš© Caution: Dependency on an object created in the component body</span>

  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre></div><p>è‹¥ useMemo çš„ä¾èµ–æ˜¯ç»„ä»¶å†…å£°æ˜çš„ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œæ¯æ¬¡æ¸²æŸ“éƒ½ä¼šé‡æ–°è¿è¡Œä¸€éç»„ä»¶å†…çš„ä»£ç ï¼Œå¯¼è‡´å¯¹è±¡é‡æ–°åˆ›å»ºï¼ŒuseMemo ä¹Ÿå°±æ­¤å¤±æ•ˆã€‚</p> <p>è¿™æ—¶å€™å¯ä»¥ç”¨ useMemo è®°å¿†è¿™ä¸ªä¾èµ–å¯¹è±¡ï¼Œå†å°†è®°å¿†ç»“æœä¼ å…¥å¦ä¸€ä¸ª hook ä½œä¸ºä¾èµ–ï¼š</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">const</span> searchOptions <span class="token operator">=</span> <span class="token function">useMemo</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token literal-property property">matchMode</span><span class="token operator">:</span> <span class="token string">'whole-word'</span><span class="token punctuation">,</span> text <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>text<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âœ… Only changes when text changes</span>

<span class="token keyword">const</span> visibleItems <span class="token operator">=</span> <span class="token function">useMemo</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">searchItems</span><span class="token punctuation">(</span>allItems<span class="token punctuation">,</span> searchOptions<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>allItems<span class="token punctuation">,</span> searchOptions<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âœ… Only changes when allItems or searchOptions changes</span>
</code></pre></div></li> <li><p>è®°å¿†å‡½æ•°</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">function</span> <span class="token function">ProductPage</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> productId<span class="token punctuation">,</span> referrer <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">function</span> <span class="token function">handleSubmit</span><span class="token punctuation">(</span><span class="token parameter">orderDetails</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/product/'</span> <span class="token operator">+</span> productId <span class="token operator">+</span> <span class="token string">'/buy'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      referrer<span class="token punctuation">,</span>
      orderDetails
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Form</span></span> <span class="token attr-name">onSubmit</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>handleSubmit<span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>å¯¹äºå°†å‡½æ•°ä½œä¸ºå±æ€§çš„ç»„ä»¶ï¼Œæ¯æ¬¡æ¸²æŸ“æ—¶éƒ½ä¼šé‡æ–°å£°æ˜å‡½æ•°ï¼Œå¯¼è‡´å†…éƒ¨å¼•ç”¨çš„ç»„ä»¶æ¯æ¬¡éƒ½æ¥å—äº†ä¸€ä¸ªä¸åŒçš„å‚æ•°ï¼Œå¦‚ä¸Šæ‰€ç¤ºã€‚è¿™æ—¶åº”è¯¥ä½¿ç”¨ useMemo è®°å¿†è¿™ä¸ªä½œä¸ºå‚æ•°çš„å‡½æ•°ï¼Œé¿å…æ— ç”¨çš„é‡æ–°æ¸²æŸ“ã€‚</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">function</span> <span class="token function">Page</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> productId<span class="token punctuation">,</span> referrer <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> handleSubmit <span class="token operator">=</span> <span class="token function">useMemo</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token parameter">orderDetails</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/product/'</span> <span class="token operator">+</span> product<span class="token punctuation">.</span>id <span class="token operator">+</span> <span class="token string">'/buy'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
        referrer<span class="token punctuation">,</span>
        orderDetails
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>productId<span class="token punctuation">,</span> referrer<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Form</span></span> <span class="token attr-name">onSubmit</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>handleSubmit<span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>å®é™…ä¸Šè®°å¿†å‡½æ•°æ›´å¥½çš„æ–¹å¼æ˜¯ç”¨ useCallback è¿™ä¸ª hookï¼Œå¯ä»¥çœå»åµŒå¥—ä¸€å±‚å‡½æ•°ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">function</span> <span class="token function">Page</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> productId<span class="token punctuation">,</span> referrer <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> handleSubmit <span class="token operator">=</span> <span class="token function">useCallback</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">orderDetails</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/product/'</span> <span class="token operator">+</span> product<span class="token punctuation">.</span>id <span class="token operator">+</span> <span class="token string">'/buy'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      referrer<span class="token punctuation">,</span>
      orderDetails
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>productId<span class="token punctuation">,</span> referrer<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Form</span></span> <span class="token attr-name">onSubmit</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>handleSubmit<span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ol> <h3 id="usecallback"><a href="#usecallback" class="header-anchor">#</a> useCallback</h3> <p>ä¸ useMemo ç±»ä¼¼ï¼ŒuseCallback å¯ä»¥åœ¨ä¸¤æ¬¡æ¸²æŸ“ä¹‹é—´ç¼“å­˜å‡½æ•°ã€‚</p> <blockquote><p>useMemo ç¼“å­˜çš„æ˜¯<strong>å‡½æ•°çš„ç»“æœ</strong>ï¼Œè€Œ useCallback ç¼“å­˜çš„æ˜¯<strong>å‡½æ•°æœ¬èº«</strong></p></blockquote> <p>ç”¨æ³•å¦‚ä¸‹ï¼š</p> <ol><li><p>è·³è¿‡é‡æ¸²æŸ“</p> <p>å¦‚ useMemo çš„ç”¨æ³•4æ‰€ç¤º</p></li> <li><p>ä»ç¼“å­˜çš„å›è°ƒä¸­æ›´æ–° state</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">const</span> <span class="token punctuation">[</span>todos<span class="token punctuation">,</span> setTodos<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> handleAddTodo <span class="token operator">=</span> <span class="token function">useCallback</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">text</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> newTodo <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">id</span><span class="token operator">:</span> nextId<span class="token operator">++</span><span class="token punctuation">,</span> text <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token function">setTodos</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">...</span>todos<span class="token punctuation">,</span> newTodo<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>todos<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>å½“æ›´æ–°çš„stateåªå–å†³äºå®ƒè‡ªèº«ä¹‹å‰çš„çŠ¶æ€æ—¶ï¼Œå¯ä»¥ç›´æ¥æŠŠä¾èµ–ç§»é™¤ï¼ˆæ”¹æˆç©ºæ•°ç»„ï¼‰</p></li> <li><p>é˜²æ­¢å‰¯ä½œç”¨è§¦å‘è¿‡äºé¢‘ç¹</p></li> <li><p>ä¼˜åŒ–è‡ªå®šä¹‰hook</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">function</span> <span class="token function">useRouter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> dispatch <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useContext</span><span class="token punctuation">(</span>RouterStateContext<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> navigate <span class="token operator">=</span> <span class="token function">useCallback</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">url</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'navigate'</span><span class="token punctuation">,</span> url <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>dispatch<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> goBack <span class="token operator">=</span> <span class="token function">useCallback</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'back'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>dispatch<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    navigate<span class="token punctuation">,</span>
    goBack<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ol> <h3 id="uselayouteffect"><a href="#uselayouteffect" class="header-anchor">#</a> useLayoutEffect</h3> <p>æ•ˆæœå’Œç”¨æ³•ä¸ useEffect å®Œå…¨ä¸€è‡´ï¼ŒåŒºåˆ«åœ¨äºï¼Œå®ƒçš„å›è°ƒä¼šåœ¨æ‰€æœ‰DOMæ“ä½œå®Œæˆä¹‹åå†æ‰§è¡Œã€‚ä¸€èˆ¬ç”¨äºè¯»å–å¸ƒå±€ååŒæ­¥æ‰§è¡Œé‡æ¸²æŸ“ã€‚</p> <h3 id="usereducer"><a href="#usereducer" class="header-anchor">#</a> useReducer</h3> <p>react å†…ç½®çš„ redux å¹³æ›¿æ–¹æ¡ˆï¼Œä¸€èˆ¬åœ¨ç»„ä»¶æœ€é¡¶å±‚å£°æ˜ï¼Œå’Œ redux ä¸€æ ·ï¼Œé€šè¿‡è‡ªå®šä¹‰çš„ reducer æ¥ç®¡ç†çŠ¶æ€ã€‚ç”¨æ³•å¦‚ä¸‹ï¼š</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> useReducer <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">reducer</span><span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> action</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ... state æ“ä½œ</span>
  <span class="token keyword">return</span> state
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">MyComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>state<span class="token punctuation">,</span> dispatch<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useReducer</span><span class="token punctuation">(</span>reducer<span class="token punctuation">,</span> initialArg<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre></div><p>useReducer æ¥å—ä¸¤ä¸ªå‚æ•°ï¼š</p> <ul><li>reducer: reducer å‡½æ•°å®šä¹‰çŠ¶æ€å¦‚ä½•æ›´æ–°ï¼Œå’Œ redux çš„ reducer åŸºæœ¬ä¸€è‡´</li> <li>initialArg: state çš„åˆå§‹å€¼</li> <li>init(å¯é€‰): å¯é€‰çš„åˆå§‹åŒ–å‡½æ•°ï¼Œå¦‚æœæä¾›äº†åˆå§‹åŒ–å‡½æ•°ï¼Œåˆ™åˆå§‹çŠ¶æ€ä¼šå˜ä¸º<code>init(initialArg)</code>çš„è®¡ç®—ç»“æœ</li></ul> <p>useReducer è¿”å›ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«ä¸¤ä¸ªå€¼ï¼Œå½“å‰çŠ¶æ€å’Œdispatchå‡½æ•°ã€‚å’Œ redux é‡Œä¸€æ ·ï¼Œdispatch å‡½æ•°ç”¨æ¥åˆ†å‘ action è§¦å‘ reducer çš„æ›´æ–° state æ“ä½œï¼Œä»è€Œè§¦å‘ react çš„é‡æ¸²æŸ“ã€‚</p> <blockquote><p>å¦‚æœæ›´æ–°stateæ—¶æä¾›çš„æ–°çš„çŠ¶æ€å’Œå…ˆå‰çŠ¶æ€å®Œå…¨ä¸€è‡´ï¼ˆåˆ¤æ–­æ ‡å‡†æ˜¯<code>Obejct.is</code>æ–¹æ³•ï¼‰ï¼Œé‚£ä¹ˆ react å°±ä¼šè·³è¿‡å¯¹è¿™ä¸ªç»„ä»¶å’Œå®ƒçš„å­ç»„ä»¶çš„é‡æ¸²æŸ“ã€‚</p></blockquote> <h4 id="å¦‚ä½•ä½¿ç”¨-usereducer-æ›¿ä»£-redux"><a href="#å¦‚ä½•ä½¿ç”¨-usereducer-æ›¿ä»£-redux" class="header-anchor">#</a> å¦‚ä½•ä½¿ç”¨ useReducer æ›¿ä»£ redux ï¼Ÿ</h4> <p>ç­”æ¡ˆæ˜¯é…åˆ useContext æ¥ä¼ é€’å…¨å±€çš„ä¸Šä¸‹æ–‡ï¼Œå­ç»„ä»¶æ¥å—dispatchå‡½æ•°ï¼Œé€šè¿‡dispatch å„ç§ action å®Œæˆå¯¹å…¨å±€ state çš„æ›´æ–°ã€‚</p> <p>ç¤ºä¾‹ï¼š<a href="../../src/functions/redux_mimic.jsx">useReducer &amp; useContext</a></p> <h2 id="hook-æ¨¡æ‹Ÿ-class-ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸ"><a href="#hook-æ¨¡æ‹Ÿ-class-ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸ" class="header-anchor">#</a> Hook æ¨¡æ‹Ÿ class ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸ</h2> <p>ç”Ÿå‘½å‘¨æœŸå‚è€ƒï¼š<a href="/./react/LifeCycle.html">Lifecycle</a></p> <h3 id="constructor"><a href="#constructor" class="header-anchor">#</a> constructor</h3> <p>ç›´æ¥ç”¨ useState</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">const</span> <span class="token punctuation">[</span>count<span class="token punctuation">,</span> setCount<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="componentdidmount"><a href="#componentdidmount" class="header-anchor">#</a> componentDidMount</h3> <p>ç”¨ useEffect åŠ ç©ºä¾èµ–</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// code</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="componentdidupdate"><a href="#componentdidupdate" class="header-anchor">#</a> componentDidUpdate</h3> <p>ç›´æ¥ç”¨ useEffect ä¼šè§¦å‘ componentDidMount å’Œ update ä¸¤ä¸ªå‘¨æœŸã€‚å¦‚æœåªæƒ³æ¨¡æ‹Ÿ update å‘¨æœŸï¼Œåº”è¯¥é…åˆ useRef ä½¿ç”¨ã€‚</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">const</span> mounted <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>mounted<span class="token punctuation">.</span>current<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    mounted<span class="token punctuation">.</span>current <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'I am didUpdate'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="componentwillunmount"><a href="#componentwillunmount" class="header-anchor">#</a> componentWillUnmount</h3> <p>useEffect ä¸­ è¿”å›å‡½æ•°</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'will unmount'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="è‡ªå®šä¹‰hook"><a href="#è‡ªå®šä¹‰hook" class="header-anchor">#</a> è‡ªå®šä¹‰Hook</h2> <p>è®¾è®¡åŸåˆ™ï¼šè‡ªå®šä¹‰çš„hookæ˜¯ç”¨æ¥å¤ç”¨å¸¦æœ‰çŠ¶æ€çš„é€»è¾‘è€Œä¸æ˜¯çŠ¶æ€æœ¬èº«ï¼Œæ¯æ¬¡å¯¹hookçš„è°ƒç”¨éƒ½æ˜¯äº’ç›¸ç‹¬ç«‹çš„ã€‚</p> <blockquote><p>Custom Hooks let you share stateful logic but not state itself. Each call to a Hook is completely independent from every other call to the same Hook.</p></blockquote> <p>ä»¥è‡ªå®šä¹‰è¡¨æ ¼ç›‘å¬hookä¸ºä¾‹ï¼š</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">function</span> <span class="token function">useFormInput</span><span class="token punctuation">(</span><span class="token parameter">initialValue</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// æ³¨æ„å®é™…å¼€å‘æ—¶ä¸åº”ä½¿ç”¨ useStateï¼Œä¼šå¯¼è‡´æŒ‰ä¸€æ¬¡é”®ç›˜å°±è§¦å‘ä¸€æ¬¡æ¸²æŸ“</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>value<span class="token punctuation">,</span> setValue<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span>initialValue<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">function</span> <span class="token function">handleChange</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">setValue</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">const</span> inputProps <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">value</span><span class="token operator">:</span> value<span class="token punctuation">,</span>
    <span class="token literal-property property">onChange</span><span class="token operator">:</span> handleChange
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> inputProps<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">Form</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> firstNameProps <span class="token operator">=</span> <span class="token function">useFormInput</span><span class="token punctuation">(</span><span class="token string">'Mary'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> lastNameProps <span class="token operator">=</span> <span class="token function">useFormInput</span><span class="token punctuation">(</span><span class="token string">'Poppins'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        First name:
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token spread"><span class="token punctuation">{</span><span class="token operator">...</span>firstNameProps<span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        Last name:
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token spread"><span class="token punctuation">{</span><span class="token operator">...</span>lastNameProps<span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>b</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">Good morning, </span><span class="token punctuation">{</span>firstNameProps<span class="token punctuation">.</span>value<span class="token punctuation">}</span><span class="token plain-text"> </span><span class="token punctuation">{</span>lastNameProps<span class="token punctuation">.</span>value<span class="token punctuation">}</span><span class="token plain-text">.</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>b</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>åœºæ™¯åˆ†æå¦‚ä¸‹ï¼š</p> <ol><li>æœ‰éœ€è¦ç»´æŠ¤çš„çŠ¶æ€ï¼ˆè¿™é‡Œæ˜¯ firstName å’Œ lastNameï¼‰</li> <li>æœ‰è´Ÿè´£ç›‘å¬çŠ¶æ€å˜åŒ–çš„handlerï¼ˆä¸¤ä¸ªonchangeï¼‰</li> <li>æœ‰ä¸º <code>&lt;input&gt;</code> ç¡®å®š value å’Œ onChange å±æ€§çš„JSXéƒ¨åˆ†</li></ol> <p>è¿™æ—¶å€™å¯ä»¥æŠŠè¿™éƒ¨åˆ†å…±åŒçš„é€»è¾‘æŠ½å–å‡ºæ¥å˜æˆä¸€ä¸ªè‡ªå®šä¹‰çš„hookï¼Œå®ç°å¦‚ä¸Šæ‰€ç¤ºã€‚</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      â†
      <a href="/./react/Higher_Order_Component.html" class="prev">
        React - é«˜é˜¶ç»„ä»¶
      </a></span> <span class="next"><a href="/./react/Lifecycle.html">
        React ç”Ÿå‘½å‘¨æœŸ
      </a>
      â†’
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="./assets/js/app.301adbdf.js" defer></script><script src="./assets/js/2.7fb28fc4.js" defer></script><script src="./assets/js/102.c227106d.js" defer></script>
  </body>
</html>
